{
    "rules": {
        ".read": "auth != null",
        ".write": "auth != null",
        "users": {
            ".read": "auth != null",
            "$userId": {
                ".write": "auth != null && (auth.uid === $userId || root.child('users').child(auth.uid).child('role').val() === 'admin')",
                "role": {
                    ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'admin'"
                },
                "activity": {
                    ".read": "auth != null && (auth.uid === $userId || root.child('users').child(auth.uid).child('role').val() === 'admin')",
                    ".write": "auth != null && (auth.uid === $userId || root.child('users').child(auth.uid).child('role').val() === 'admin')",
                    ".indexOn": ["timestamp", "action"],
                    "$activityId": {
                        ".validate": "newData.hasChildren(['action', 'timestamp'])"
                    }
                }
            }
        },
        "roles": {
            ".read": true,
            ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'admin'"
        },
        "deployments": {
            "history": {
                ".indexOn": ["environment", "startTime", "timestamp"]
            },
            "environments": {
                ".indexOn": ["name", "status"]
            }
        },
        "audit_logs": {
            "deployments": {
                ".indexOn": ["timestamp", "action"]
            }
        },
        "system_activity": {
            ".read": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'admin'",
            ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'admin'",
            ".indexOn": ["timestamp", "action"],
            "$activityId": {
                ".validate": "newData.hasChildren(['action', 'timestamp'])"
            }
        },
        "blend-monitor": {
            ".read": "auth != null",
            ".write": "auth != null",
            "components": {
                ".read": "auth != null",
                ".write": "auth != null",
                "$componentId": {
                    ".validate": "newData.hasChildren(['name', 'path', 'instances'])"
                }
            },
            "coverage": {
                ".read": "auth != null",
                ".write": "auth != null",
                "$coverageId": {
                    ".validate": "newData.hasChildren(['timestamp', 'percentage'])"
                }
            },
            "publishing": {
                ".read": "auth != null",
                ".write": "auth != null",
                "npm": {
                    "stats": {
                        ".read": "auth != null",
                        ".write": "auth != null"
                    },
                    "versions": {
                        ".read": "auth != null",
                        ".write": "auth != null"
                    },
                    "trends": {
                        ".read": "auth != null",
                        ".write": "auth != null"
                    }
                }
            }
        }
    }
}
